# URL Shortener (Golang) üöÄ

–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ **Go** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **–Ø–∑—ã–∫:** Go 1.25.6
- **HTTP –†–æ—É—Ç–µ—Ä:** [chi](https://github.com/go-chi/chi)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite (—á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ PostgreSQL)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä `slog`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** [go-playground/validator](https://github.com/go-playground/validator)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker (Multi-stage build), Docker Compose
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
  - Unit-—Ç–µ—Å—Ç—ã: `testify` + `mockery`
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ (E2E) —Ç–µ—Å—Ç—ã: `httpexpect`

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/ShaPen2k/url-shortener-go.git
cd url-shortener
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏—â–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –≤ `config/local.yaml`. –í–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

**–î–ª—è Linux/macOS:**

```bash
cp config/local.yaml.example config/local.yaml
```

**–î–ª—è Windows (PowerShell):**

```bash
copy config/local.yaml.example config/local.yaml
```

> **–í–∞–∂–Ω–æ:** –û—Ç–∫—Ä–æ–π—Ç–µ `config/local.yaml` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `address` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ `0.0.0.0:8082` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π, –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è Go –∏ SQLite –ª–æ–∫–∞–ª—å–Ω–æ.

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π [Docker Desktop](https://www.docker.com/products/docker-desktop/)

### –ó–∞–ø—É—Å–∫

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Å–æ–∑–¥–∞–ª–∏ `config/local.yaml` (—Å–º. —à–∞–≥ –≤—ã—à–µ).
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```bash
   docker-compose up --build -d
   ```
3. –°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8082`.

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker

- **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:** `docker logs -f url-shortener-app`
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞:** `docker-compose down`
- **–ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞:** `docker-compose up --build -d`

---

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä—è–º—É—é:

```bash
go run cmd/url-shortener/main.go
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ (Unit –∏ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ):

```bash
go test -v ./...
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∫–æ–≤ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ mockery):

```bash
go generate ./...
```

## üîå API Endpoints

|   –ú–µ—Ç–æ–¥    | –ü—É—Ç—å           | –û–ø–∏—Å–∞–Ω–∏–µ                     |    Auth    |
| :--------: | :------------- | :--------------------------- | :--------: |
|  **GET**   | `/health`      | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞    |    –ù–µ—Ç     |
|  **POST**  | `/url`         | –°–æ–∑–¥–∞—Ç—å –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É      | –î–∞ (Basic) |
|  **GET**   | `/{alias}`     | –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL |    –ù–µ—Ç     |
| **DELETE** | `/url/{alias}` | –£–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É               | –î–∞ (Basic) |

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (curl)

**1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞:**

```bash
curl -X GET http://localhost:8082/health
```

**2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Å—ã–ª–∫–∏ (POST /url):**

```bash
curl -X POST http://localhost:8082/url \
  -H "Content-Type: application/json" \
  -u myuser:mypass \
  -d '{
    "url": "https://google.com",
    "alias": "google-link"
  }'
```

**3. –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ alias (GET /{alias}):**

```bash
curl -X GET http://localhost:8082/google-link -L
```

**4. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (DELETE /url/{alias}):**

```bash
curl -X DELETE http://localhost:8082/url/google-link \
  -u myuser:mypass
```

**5. –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è alias (–±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è):**

```bash
curl -X POST http://localhost:8082/url \
  -H "Content-Type: application/json" \
  -u myuser:mypass \
  -d '{
    "url": "https://github.com"
  }'
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—É—Å–ø–µ—Ö)

```json
{
	"status": "OK",
	"alias": "abc123"
}
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–æ—à–∏–±–∫–∞)

```json
{
	"status": "Error",
	"error": "field URL is a required field"
}
```

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ —Å–ª–æ—è–º:

- **cmd/** ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
- **internal/config/** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫.
- **internal/http-server/handlers/** ‚Äî –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤.
- **internal/storage/** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (Repository).
- **internal/lib/** ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –ª–æ–≥–≥–µ—Ä—ã –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
